<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/png" href="assets/img/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>
        {% block title %}
            Django TodoList
        {% endblock %}
    </title>
    {% load static %}
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />

    <!-- Bootstrap core CSS     -->
    <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet" />

    <!-- Animation library for notifications   -->
    <link href="{% static "css/animate.min.css" %}" rel="stylesheet"/>

    <!--  Light Bootstrap Table core CSS    -->
    <link href="{% static "css/light-bootstrap-dashboard.css" %}" rel="stylesheet"/>

    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300' rel='stylesheet' type='text/css'>
    <link href="{% static "css/pe-icon-7-stroke.css" %}" rel="stylesheet" />

</head>
<body>

<div class="wrapper">
    <div class="sidebar" data-color="blue">

    <!--   you can change the color of the sidebar using: data-color="blue | azure | green | orange | red | purple" -->


    	<div class="sidebar-wrapper">
            <div class="logo">
                <a href="http://www.github.com/lucasvieiramay" class="simple-text" target="_blank">
                    DjangoTodoList
                </a>
            </div>

            <ul class="nav">
                <li class="active">
                    <a href="/">
                        <i class="pe-7s-note2"></i>
                        <p>Tasks List</p>
                    </a>
                </li>
            </ul>
    	</div>
    </div>

    <div class="main-panel">
        <div class="content">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-12">
                        {% block content %}
                        <div class="card">
                            <div class="content table-responsive table-full-width">
                                <table class="table table-hover table-striped">
                                    <form method="POST" action="/create/" onsubmit="return validTask()">
                                        <thead>
                                            <tr>
                                                <div class="col-md-5">
                                                    <input class="form-control" maxlength="255" type="text" name="title" id="title" placeholder="Type your task here...">
                                                </div>
                                                <div class="col-md-2">
                                                    <button class="btn btn-success" type="submit">Add Task</button>
                                                </div>
                                                <div class="col-md-2">
                                                    <button class="btn btn-success" type="submit">Add Task</button>
                                                </div>
                                                <div class="col-md-3" style="margin-top:10px;">
                                                    <input
                                                        onclick="showArchivedTasks()"
                                                        type="checkbox"
                                                        name="show_archived"
                                                        id="show_archived">
                                                            Show archived tasks
                                                    </input>
                                                </div>
                                            </tr>
                                            <br/>
                                            <br/>
                                            <br/>
                                        </thead>
                                    </form>
                                    <tbody>
                                        {% if tasks %}
                                            {% for task in tasks %}
                                                <tr>
                                                    <td class="col-md-1" onclick="completeTask({{task.pk}})" data-toggle="tooltip" title="Mark as Done">
                                                        <div style="cursor:pointer;">
                                                            <i style="color: green;" class="fa fa-check" aria-hidden="true"></i>
                                                        </div>
                                                    </td>
                                                    <td class="col-md-8" data-toggle="tooltip" title="Title">{{task.title}}</td>
                                                    {% if task.label == 1 %}
                                                        <td class="col-md-1" data-toggle="tooltip" title="Priority">
                                                            <i style="color: red;" class="fa fa-flag" aria-hidden="true"></i>
                                                        </td>
                                                    {% elif task.label == 2 %}
                                                        <td class="col-md-1" data-toggle="tooltip" title="Priority">
                                                            <i style="color: orange;" class="fa fa-flag" aria-hidden="true"></i>
                                                        </td>
                                                    {% else %}
                                                        <td class="col-md-1" data-toggle="tooltip" title="Priority">
                                                            <i style="color: green;" class="fa fa-flag" aria-hidden="true"></i>
                                                        </td>
                                                    {% endif %}
                                                    <td class="col-md-1" onclick="archiveTask({{task.pk}})" data-toggle="tooltip" title="Archive">
                                                        <div style="cursor:pointer;">
                                                            {% if task.archived %}
                                                                <i style="color: orange;" class="fa fa-archive" aria-hidden="true"></i>
                                                            {% else %}
                                                                <i style="color: #dddddd;" class="fa fa-archive" aria-hidden="true"></i>
                                                            {% endif %}
                                                        </div>
                                                    </td>
                                                    <td class="col-md-1" onclick="deleteTask({{task.pk}})" data-toggle="tooltip" title="Delete">
                                                        <div style="cursor:pointer;">
                                                            <i style="color: red;" class="fa fa-trash" aria-hidden="true"></i>
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        {% else %}
                                            <div style="text-align: center;">
                                                <p> Enjoy your free day, you don't have any task =) </p>
                                                <img src="{% static "img/beer.png" %}">
                                                <br/>
                                                <br/>
                                                <br/>
                                            </div>
                                        {% endif %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        {% endblock %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


</body>

    <!--   Core JS Files   -->
    <script src="{% static "js/jquery-1.10.2.js" %}" type="text/javascript"></script>
    <script src="{% static "js/bootstrap.min.js" %}" type="text/javascript"></script>

    <!--  Checkbox, Radio & Switch Plugins -->
    <script src="{% static "js/bootstrap-checkbox-radio-switch.js" %}"></script>

    <!--  Notifications Plugin    -->
    <script src="{% static "js/bootstrap-notify.js" %}"></script>

    <!-- Light Bootstrap Table Core javascript and methods for Demo purpose -->
    <script src="{% static "js/light-bootstrap-dashboard.js" %}"></script>
    <script type="text/javascript">

        function validTask(){
        if(document.getElementById("title").value ==""){
            alert("Fill the Title");
            return false;
            }
        }

        function completeTask(taskId){
            $.post(
                "/complete-task/",
                {
                    task_id: taskId
                },
                function(data) {
                    // Hard reload
                    // TODO: Make a Soft reload here
                    location.reload();
                }
            );
        }

        function deleteTask(taskId){
            $.post(
                "/delete-task/",
                {
                task_id: taskId},
                function(data) {
                    // Hard reload
                    // TODO: Make a Soft reload here
                    location.reload();
                }
            );
        }

        function archiveTask(taskId){
            $.post(
                "/archive-task/",
                {
                task_id: taskId},
                function(data) {
                    window.location.replace("/");
                }
            );
        }

        function showArchivedTasks(){
            window.location.replace("/?showArchived=True");
        }

    </script>
</html>
